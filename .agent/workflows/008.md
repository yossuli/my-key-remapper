---
description: 制御コンポーネントによる宣言的な条件付きレンダリング
---

# [Workflow-008] 制御コンポーネントによる宣言的な条件付きレンダリング

## 概要

JSX 内で三項演算子 (`? :`) や論理演算子 (`&&`)、`Array.map` を多用すると、記述が命令的になり可読性が低下します。
これを `src/renderer/src/components/control` にある制御コンポーネント群に置き換えることで、UI の構造をより宣言的で意図が明確な形式に統一します。

## 対象コンポーネントと使い分け

| コンポーネント  | 用途（置き換え前）                | 特徴・メリット                                                      |
| :-------------- | :-------------------------------- | :------------------------------------------------------------------ |
| **Show**        | `condition && children`           | 単純な ON/OFF。レンダリングコストを抑えた宣言的な記述。             |
| **With**        | `value ? children(value) : null`  | null/undefined チェックと値の利用。スコープ変数として安全に扱える。 |
| **Mapped**      | `array.map(...)`                  | 配列のレンダリング。`as` プロパティで外側のタグを指定可能。         |
| **Ternary**     | `cond ? then : else`              | `Then` / `Else` サブコンポーネントを使い、分岐を構造化する。        |
| **Switch**      | `switch-case` / 複雑な `if-else`  | `Case` / `DefineCase` / `Default` による多分岐。                    |
| **HandleEmpty** | `Mapped` + `Ternary` (Empty 表示) | 配列が空の場合のフォールバック表示を内包。                          |

## Bad/Good Example

### Bad (命令的な三項演算子や map)

```tsx
{
  items.length > 0 ? (
    <ul className="list">
      {items.map((item) => (
        <li key={item.id}>{item.name}</li>
      ))}
    </ul>
  ) : (
    <EmptyState />
  );
}
```

### Good (宣言的な制御コンポーネント)

```tsx
<HandleEmpty array={items} empty={<EmptyState />}>
  {(item) => <li className="item">{item.name}</li>}
</HandleEmpty>
```

## 手順 (Step-by-Step)

### 1. 制御コンポーネントのインポート

`@/components/control` から必要なコンポーネントをインポートします。

```typescript
import {
  Show,
  With,
  Mapped,
  Ternary,
  Then,
  Else,
  Switch,
  Case,
  Default,
  HandleEmpty,
} from "@/components/control";
```

### 2. 命令的な記述の特定

JSX 内で条件分岐や繰り返しを行っている箇所を特定します。

### 3. 最適なコンポーネントへの置き換え

上記の「使い分け」表に基づき、最適なコンポーネントを選択してリファクタリングします。

## チェックリスト

- [ ] 三項演算子や `&&`、`.map()` が制御コンポーネントに置き換わっているか？
- [ ] `@/components/control` から正しくインポートされているか？
- [ ] `With` や `Mapped` のコールバック関数内で、型安全に値が扱えているか？
- [ ] `npm run build` で型エラーが発生しないか？
